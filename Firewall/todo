1. фаервол принимает уже сконструированные правила, их созданием должна заниматься фабрика
2. Парсинг строки не должен идти по количеству аргументов
3. Системные фукнции парсера не стоит светить наружу, их можно убрать из заголовочного файла
4. Кидать wrong_format_error() нехорошо.
5. Заменить вызовы new на make_unique<base_rule>